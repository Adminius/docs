"use strict";(self.webpackChunkevcc_docs=self.webpackChunkevcc_docs||[]).push([[8431],{8431:(e,t,s)=>{s.r(t),s.d(t,{diagram:()=>I});var o=s(1453),r=s(5625),a=s(9373),i=s(1896),n=s(66),d=s(3364),c=s(3622);s(7856),s(1941),s(277),s(9354),s(7967);const l="rect",p="rectWithTitle",g="statediagram",b=`${g}-state`,h="transition",u=`${h} note-edge`,y=`${g}-note`,f=`${g}-cluster`,w=`${g}-cluster-alt`,x="parent",$="note",m="state",T="----",S=`${T}${$}`,k=`${T}${x}`,v="fill:none",D="fill: #333",A="text",B="normal";let E={},C=0;function R(e="",t=0,s="",o=T){const r=null!==s&&s.length>0?`${o}${s}`:"";return`${m}-${e}${r}-${t}`}const V=(e,t,s,r,a,n)=>{const d=s.id,c=null==(g=r[d])?"":g.classes?g.classes.join(" "):"";var g;if("root"!==d){let t=l;!0===s.start&&(t="start"),!1===s.start&&(t="end"),s.type!==o.a&&(t=s.type),E[d]||(E[d]={id:d,shape:t,description:i.d.sanitizeText(d,(0,i.g)()),classes:`${c} ${b}`});const r=E[d];s.description&&(Array.isArray(r.description)?(r.shape=p,r.description.push(s.description)):r.description.length>0?(r.shape=p,r.description===d?r.description=[s.description]:r.description=[r.description,s.description]):(r.shape=l,r.description=s.description),r.description=i.d.sanitizeTextOrArray(r.description,(0,i.g)())),1===r.description.length&&r.shape===p&&(r.shape=l),!r.type&&s.doc&&(i.l.info("Setting cluster for ",d,M(s)),r.type="group",r.dir=M(s),r.shape=s.type===o.b?"divider":"roundedWithTitle",r.classes=r.classes+" "+f+" "+(n?w:""));const a={labelStyle:"",shape:r.shape,labelText:r.description,classes:r.classes,style:"",id:d,dir:r.dir,domId:R(d,C),type:r.type,padding:15};if(s.note){const t={labelStyle:"",shape:"note",labelText:s.note.text,classes:y,style:"",id:d+S+"-"+C,domId:R(d,C,$),type:r.type,padding:15},o={labelStyle:"",shape:"noteGroup",labelText:s.note.text,classes:r.classes,style:"",id:d+k,domId:R(d,C,x),type:"group",padding:0};C++;const i=d+k;e.setNode(i,o),e.setNode(t.id,t),e.setNode(d,a),e.setParent(d,i),e.setParent(t.id,i);let n=d,c=t.id;"left of"===s.note.position&&(n=t.id,c=d),e.setEdge(n,c,{arrowhead:"none",arrowType:"",style:v,labelStyle:"",classes:u,arrowheadStyle:D,labelpos:"c",labelType:A,thickness:B})}else e.setNode(d,a)}t&&"root"!==t.id&&(i.l.trace("Setting node ",d," to be child of its parent ",t.id),e.setParent(d,t.id)),s.doc&&(i.l.trace("Adding nodes children "),N(e,s,s.doc,r,a,!n))},N=(e,t,s,r,a,n)=>{i.l.trace("items",s),s.forEach((s=>{switch(s.stmt){case o.c:case o.a:V(e,t,s,r,a,n);break;case o.S:{V(e,t,s.state1,r,a,n),V(e,t,s.state2,r,a,n);const o={id:"edge"+C,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:v,labelStyle:"",label:i.d.sanitizeText(s.description,(0,i.g)()),arrowheadStyle:D,labelpos:"c",labelType:A,thickness:B,classes:h};e.setEdge(s.state1.id,s.state2.id,o,C),C++}}}))},M=(e,t=o.e)=>{let s=t;if(e.doc)for(let o=0;o<e.doc.length;o++){const t=e.doc[o];"dir"===t.stmt&&(s=t.value)}return s},z={setConf:function(e){const t=Object.keys(e);for(const s of t)e[s]},getClasses:function(e,t){i.l.trace("Extracting classes"),t.db.clear();try{return t.parser.parse(e),t.db.extract(t.db.getRootDocV2()),t.db.getClasses()}catch(s){return s}},draw:function(e,t,s,p){i.l.info("Drawing state diagram (v2)",t),E={};let b=p.db.getDirection();void 0===b&&(b=o.D);const{securityLevel:h,state:u}=(0,i.g)(),y=u.nodeSpacing||50,f=u.rankSpacing||50;i.l.info(p.db.getRootDocV2()),p.db.extract(p.db.getRootDocV2()),i.l.info(p.db.getRootDocV2());const w=p.db.getStates(),x=new r.k({multigraph:!0,compound:!0}).setGraph({rankdir:M(p.db.getRootDocV2()),nodesep:y,ranksep:f,marginx:8,marginy:8}).setDefaultEdgeLabel((function(){return{}}));let $;V(x,void 0,p.db.getRootDocV2(),w,p.db,!0),"sandbox"===h&&($=(0,a.Ys)("#i"+t));const m="sandbox"===h?(0,a.Ys)($.nodes()[0].contentDocument.body):(0,a.Ys)("body"),T=m.select(`[id="${t}"]`),S=m.select("#"+t+" g");(0,n.r)(S,x,["barb"],g,t);c.u.insertTitle(T,"statediagramTitleText",u.titleTopMargin,p.db.getDiagramTitle());const k=T.node().getBBox(),v=k.width+16,D=k.height+16;T.attr("class",g);const A=T.node().getBBox();(0,d.c)(T,D,v,u.useMaxWidth);const B=`${A.x-8} ${A.y-8} ${v} ${D}`;i.l.debug(`viewBox ${B}`),T.attr("viewBox",B);const C=document.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const o of C){const e=o.getBBox(),t=document.createElementNS("http://www.w3.org/2000/svg",l);t.setAttribute("rx",0),t.setAttribute("ry",0),t.setAttribute("width",e.width),t.setAttribute("height",e.height),o.insertBefore(t,o.firstChild)}}},I={parser:o.p,db:o.d,renderer:z,styles:o.s,init:e=>{e.state||(e.state={}),e.state.arrowMarkerAbsolute=e.arrowMarkerAbsolute,o.d.clear()}}}}]);