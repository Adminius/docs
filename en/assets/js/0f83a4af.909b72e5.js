"use strict";(self.webpackChunkevcc_docs=self.webpackChunkevcc_docs||[]).push([[1138],{8424:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>c,toc:()=>h});var t=n(5893),s=n(1151);const r={sidebar_position:4},a="Vehicles",c={id:"guides/vehicles",title:"Vehicles",description:"Why would I want to add my car to evcc?",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/guides/vehicles.mdx",sourceDirName:"guides",slug:"/guides/vehicles",permalink:"/en/docs/guides/vehicles",draft:!1,unlisted:!1,editUrl:"https://github.com/evcc-io/docs/tree/main/i18n/en/docusaurus-plugin-content-docs/current/guides/vehicles.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Charging",permalink:"/en/docs/guides/charging"},next:{title:"Meters / Site",permalink:"/en/docs/guides/meters"}},o={},h=[{value:"Why would I want to add my car to evcc?",id:"why-would-i-want-to-add-my-car-to-evcc",level:3},{value:"Is my car supported?",id:"is-my-car-supported",level:3},{value:"What&#39;s this about Air Conditioning / pre-climatisation?",id:"whats-this-about-air-conditioning--pre-climatisation",level:3},{value:"Determining which Vehicle is at which Charger",id:"determining-which-vehicle-is-at-which-charger",level:2},{value:"Detection via Charging Cable",id:"detection-via-charging-cable",level:3},{value:"Detection via RFID / NFC",id:"detection-via-rfid--nfc",level:3},{value:"Recognition based on Charging Status",id:"recognition-based-on-charging-status",level:3},{value:"Manufacturer-Specific Special Stuff",id:"manufacturer-specific-special-stuff",level:2},{value:"PSA (Peugeot / Citro\xebn / Vauxhall / Opel): Charging status is only updated when I use the app",id:"psa-peugeot--citro\xebn--vauxhall--opel-charging-status-is-only-updated-when-i-use-the-app",level:3},{value:"Mercedes: Special instructions for finding <code>clientId</code> and <code>clientSecret</code>",id:"mercedes-special-instructions-for-finding-clientid-and-clientsecret",level:3}];function l(e){const i={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"vehicles",children:"Vehicles"}),"\n",(0,t.jsx)(i.h3,{id:"why-would-i-want-to-add-my-car-to-evcc",children:"Why would I want to add my car to evcc?"}),"\n",(0,t.jsx)(i.p,{children:"evcc can limit charging to a chosen State of Charge (SoC), but to do this, it must know the current SoC of the vehicle involved."}),"\n",(0,t.jsx)(i.p,{children:"Unfortunately, most cars and Chargers cannot exchange this information directly. The good news is that many vehicle manufacturers offer some kind of app or online service that provides this information to the user. evcc can, therefore, access this data itself on a regular basis through these online services."}),"\n",(0,t.jsx)(i.p,{children:"To do this, you usually need to enter the username and password for the manufacturer app in the evcc configuration - evcc will then be able to read out the charging status."}),"\n",(0,t.jsx)(i.h3,{id:"is-my-car-supported",children:"Is my car supported?"}),"\n",(0,t.jsxs)(i.p,{children:["Quite possibly! Take a look in ",(0,t.jsx)(i.a,{href:"/docs/devices/vehicles",children:"Devices - Vehicles"})," - if you can't find your vehicle there, try a similar configuration from the same manufacturer (or family of manufacturers)."]}),"\n",(0,t.jsx)(i.h3,{id:"whats-this-about-air-conditioning--pre-climatisation",children:"What's this about Air Conditioning / pre-climatisation?"}),"\n",(0,t.jsx)(i.p,{children:"With some vehicles, evcc can also recognise via the online connection whether the vehicle is carrying out pre-climatisation (pre-conditioning).\nIf it detects this, evcc will then ensure that the Charger is providing at least the minimum possible power to the vehicle, so that pre-conditioning therefore happens without discharging the vehicle's onboard battery."}),"\n",(0,t.jsx)(i.p,{children:"In some cases, the vehicle may need less power to perform pre-climatisation than the minimum supplied by the Charger.\nIf this is the case, the vehicle will usually charge the onboard battery with any remaining power - please note that this will happen even if a pre-defined SoC limit has been reached."}),"\n",(0,t.jsxs)(i.admonition,{title:"ISO15118",type:"note",children:[(0,t.jsx)(i.p,{children:"The above applies to most configurations of vehicle and Charger (IEC61851)."}),(0,t.jsx)(i.p,{children:"In the case of vehicles and chargers that communicate using ISO15118, the vehicle will get exactly the amount of power it requests from the Charger (which is usually just pre-conditioning)."})]}),"\n",(0,t.jsx)(i.h2,{id:"determining-which-vehicle-is-at-which-charger",children:"Determining which Vehicle is at which Charger"}),"\n",(0,t.jsx)(i.p,{children:"If one or more Vehicles are configured, evcc must be able to distinguish them, and know which vehicle is connected to which Charger. This is in order to ensure that live data is correct for each Charger, and thus limit charging to a given State of Charge."}),"\n",(0,t.jsx)(i.p,{children:"There are a few different ways to go about this:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"A Charger is directly assigned to a Vehicle - there is no need for detection at all, and evcc presumes that the vehicle connected to the given Charger is the configured one."}),"\n",(0,t.jsxs)(i.li,{children:["In the case of many Vehicles that may move between Chargers:","\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Detection via Charging Cable (aka Plug & Charge)"}),"\n",(0,t.jsx)(i.li,{children:"Detection via RFID / NFC card / token"}),"\n",(0,t.jsx)(i.li,{children:"Recognition based on charging status"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"The individual methods are described in more detail below."}),"\n",(0,t.jsx)(i.p,{children:"If none of these options are possible or sensible, Vehicles should be assigned to Chargers manually via the evcc user interface (or via the API) - corrections can also be made there if necessary."}),"\n",(0,t.jsx)(i.p,{children:'Vehicles that are not yet recognised are treated as "guest vehicles".'}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsx)(i.p,{children:"The Charger must already be set up and configured in evcc."})}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["For most simple installations, we advise making a direct assignment between a Charger and a Vehicle.\n(See ",(0,t.jsx)(i.a,{href:"/docs/reference/configuration/loadpoints/#vehicles",children:"Vehicle"})," for more information)"]})}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["For each Vehicle, individual base settings such as charging status, charging current restrictions, target SoC, etc. can be set in evcc.yaml (see ",(0,t.jsx)(i.a,{href:"/docs/reference/configuration/vehicles/#onidentify",children:"onIdentify"}),").\nThese are then used automatically if the vehicle is recognised or assigned to a Charger."]})}),"\n",(0,t.jsx)(i.h3,{id:"detection-via-charging-cable",children:"Detection via Charging Cable"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Prerequisite"}),": Both the Charger and the Vehicle must support ISO15118 (Plug & Charge). In practice, this is only possible with a few Charger and Vehicle combinations. ",(0,t.jsx)(i.em,{children:"Please ensure both support this functionality before proceeding!"})]}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsx)(i.p,{children:'Please ensure that any relevant "Plug & Charge" settings are enabled on your Charger.'})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Procedure"}),":"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Connect the Vehicle to the Charger"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Stop evcc (if it's already running)"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Issue the command ",(0,t.jsx)(i.code,{children:"evcc charger"})," on the command line"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["The output will contain the line ",(0,t.jsx)(i.code,{children:"identifier:"})," and then a value - make a note of this value"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Now open ",(0,t.jsx)(i.code,{children:"evcc.yaml"})," in your favorite editor"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Add the following to your configuration against the corresponding vehicle (identifiers are a list, so several entries are possible if needed):"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-yaml",children:"identifiers:\n  - <identifier>\n"})}),"\n",(0,t.jsxs)(i.admonition,{type:"note",children:[(0,t.jsx)(i.p,{children:"If the Vehicle does not properly support Plug & Charge, the vehicle may deliver its hardware address (MAC address).\nSome Vehicles (such as older Volkswagen & Audi models) change them routinely to random values!"}),(0,t.jsx)(i.p,{children:"In these cases, you might find it possible to identify a vehicle using a wildcard, specifying only the part of the address that remains static:"}),(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-yaml",children:"vehicles:\n  - name: BeepBoop\n    ...\n    identifiers:\n      - 01:23:45:*\n"})}),(0,t.jsx)(i.p,{children:"Of course, this only works if you haven't got multiple vehicles with the same behavior, and so long as the first part of the address remains static."})]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"You can now restart evcc, which will hopefully recognise the vehicle!"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"detection-via-rfid--nfc",children:"Detection via RFID / NFC"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Prerequisite:"})," The Charger must have an RFID / NFC reader."]}),"\n",(0,t.jsx)(i.p,{children:"With this option, you assign one or more RFID cards to a specific vehicle. When you connect a vehicle to a Charger, you start the charging process using its corresponding RFID card.\nThe Wallbox will then announce which card was used for detection, which is processed by evcc."}),"\n",(0,t.jsx)(i.p,{children:"Sometimes, a Charger will not announce exactly what card number / RFID identifier was used for identification, instead opting only to send an alias name or similar configured on the Charger itself.\nThis works a little differently on a charger-by-charger basis, so it's worth following this guide to make sure yours works as expected."}),"\n",(0,t.jsxs)(i.admonition,{type:"note",children:[(0,t.jsx)(i.p,{children:"The RFID cards permitted usually have to be registered at the Charger, usually via a configuration application or its user interface."}),(0,t.jsx)(i.p,{children:'This can sometimes take the form of a "Allow External Cards" toggle.'})]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Procedure"}),":"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Hold the RFID / NFC card / token up to your Charger until it reports that it has been recognised in some way"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Stop evcc (if it's already running)"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Issue the command ",(0,t.jsx)(i.code,{children:"evcc charger"})," on the command line"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["The output will contain the line ",(0,t.jsx)(i.code,{children:"identifier:"})," and then a value - make a note of this value"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Now open ",(0,t.jsx)(i.code,{children:"evcc.yaml"})," in your favorite editor"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Add the following to your configuration against the corresponding vehicle (identifiers are a list, so several entries are possible if needed):"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-yaml",children:"vehicles:\n  - name: BeepBoop\n    ...\n    identifiers:\n      - <identifier>\n"})}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"You can now restart evcc, which will hopefully recognise the vehicle!"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["The structure of the identifier transmitted by a Charger sometimes varies after the first use. If you're having issues, verify the identifer is as expected using ",(0,t.jsx)(i.code,{children:"evcc charger"}),"."]})}),"\n",(0,t.jsx)(i.admonition,{type:"caution",children:(0,t.jsx)(i.p,{children:"A RFID card can have different identifiers on different Chargers - test against all of your Chargers!"})}),"\n",(0,t.jsx)(i.h3,{id:"recognition-based-on-charging-status",children:"Recognition based on Charging Status"}),"\n",(0,t.jsx)(i.p,{children:"With this method, evcc regularly checks the charging status of all configured Vehicles over the internet.\nBy comparing this state with the current condition of the Chargers, evcc tries to figure out which vehicle has just been connected to a Charger."}),"\n",(0,t.jsx)(i.p,{children:"This is a heuristic procedure, and there is therefore no 100% guarantee of accuracy.\nThe speed and reliability of this procedure depends heavily on the speed and reliability of the live data from the vehicle, which may be inhibited by things such as manufacturer servers, cell service, etc."}),"\n",(0,t.jsxs)(i.admonition,{type:"info",children:[(0,t.jsx)(i.p,{children:"Detection via online services can fail for a number of reasons, including:"}),(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"the vehicle is temporarily unavailable (out of service)"}),"\n",(0,t.jsx)(i.li,{children:"the vehicle manufacturer's server is temporarily unavailable"}),"\n",(0,t.jsx)(i.li,{children:"new terms and conditions need to be agreed to (on the website / in the app / in the vehicle)"}),"\n",(0,t.jsx)(i.li,{children:"there was a change to the online service by the manufacturer, rendering evcc unable to interpret data from it"}),"\n"]})]}),"\n",(0,t.jsx)(i.h2,{id:"manufacturer-specific-special-stuff",children:"Manufacturer-Specific Special Stuff"}),"\n",(0,t.jsx)(i.h3,{id:"psa-peugeot--citro\xebn--vauxhall--opel-charging-status-is-only-updated-when-i-use-the-app",children:"PSA (Peugeot / Citro\xebn / Vauxhall / Opel): Charging status is only updated when I use the app"}),"\n",(0,t.jsx)(i.p,{children:"This is unfortunately a restriction of the manufacturer's online service - PSA delivers outdated values until they are renewed by opening the mobile app."}),"\n",(0,t.jsx)(i.p,{children:"Sadly, no workaround to this issue has been found."}),"\n",(0,t.jsxs)(i.h3,{id:"mercedes-special-instructions-for-finding-clientid-and-clientsecret",children:["Mercedes: Special instructions for finding ",(0,t.jsx)(i.code,{children:"clientId"})," and ",(0,t.jsx)(i.code,{children:"clientSecret"})]}),"\n",(0,t.jsx)(i.p,{children:"Mercedes vehicles require two IDs to be generated and stored in evcc.yaml. To do this:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Create a Mercedes Developer account."}),"\n",(0,t.jsx)(i.li,{children:'Log in, and select "Create a New Project"'}),"\n",(0,t.jsx)(i.li,{children:'Click "Add Product"'}),"\n",(0,t.jsx)(i.li,{children:'Ensure "Electric Vehicle Status" is selected'}),"\n",(0,t.jsx)(i.li,{children:"Purchase model -> Get For Free -> Package BYOCAR -> Confirm -> Subscribe"}),"\n",(0,t.jsx)(i.li,{children:"Go to Project Page -> Generate Credentials"}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.strong,{children:"Make a note of Client ID and Client Secret somewhere safe - you won't be able to get these again!"})}),"\n",(0,t.jsxs)(i.li,{children:["In Project credentials, set the following Redirect URL:\n",(0,t.jsx)(i.code,{children:"http://EVCC_IP:7070/oauth/vehicles/1/callback"})," (where ",(0,t.jsx)(i.code,{children:"EVCC_IP"})," corresponds to the address which you usually access evcc)","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"This applies even if evcc is running purely inside your local area network."}),"\n",(0,t.jsx)(i.li,{children:"Please note that port 7070 must be forwarded in your router's interface."}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Important"}),": evcc does not have any kind of authentication, so anyone will be able to access your evcc installation unless you mitigate somehow - this is up to you to configure!"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["Set the corresponding identifiers in your evcc.yaml:","\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"- name: merc\n  type: mercedes\n  title: MyReallyCoolMerc\n  capacity: 80 # battery capacity kWh\n  clientId: xxx\n  clientSecret: xxx\n  vin: xxxxx # vin number\n"})}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},1151:(e,i,n)=>{n.d(i,{Z:()=>c,a:()=>a});var t=n(7294);const s={},r=t.createContext(s);function a(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:i},e.children)}}}]);