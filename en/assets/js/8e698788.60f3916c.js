"use strict";(self.webpackChunkevcc_docs=self.webpackChunkevcc_docs||[]).push([[7858],{3957:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>c,metadata:()=>l,toc:()=>u});var i=t(5893),s=t(1151),o=t(4866),r=t(5162);const c={sidebar_position:4},a="Docker / containerd",l={id:"installation/docker",title:"Docker / containerd",description:"evcc can be installed as a Docker / Container image. This also works on some common NAS systems, such as Synology.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/installation/docker.mdx",sourceDirName:"installation",slug:"/installation/docker",permalink:"/en/docs/installation/docker",draft:!1,unlisted:!1,editUrl:"https://github.com/evcc-io/docs/tree/main/i18n/en/docusaurus-plugin-content-docs/current/installation/docker.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"macOS",permalink:"/en/docs/installation/macos"},next:{title:"Manual (including Windows)",permalink:"/en/docs/installation/manual"}},d={},u=[{value:"Configuration",id:"configuration",level:2},{value:"Installation",id:"installation",level:2},{value:"Command Line",id:"command-line",level:3},{value:"With docker-compose",id:"with-docker-compose",level:3},{value:"Useful Commands",id:"useful-commands",level:2},{value:"Upgrades",id:"upgrades",level:2},{value:"NAS systems",id:"nas-systems",level:2},{value:"Synology NAS",id:"synology-nas",level:3},{value:"QNAP NAS",id:"qnap-nas",level:4}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"docker--containerd",children:"Docker / containerd"}),"\n",(0,i.jsx)(n.p,{children:"evcc can be installed as a Docker / Container image. This also works on some common NAS systems, such as Synology."}),"\n",(0,i.jsxs)(n.admonition,{type:"important",children:[(0,i.jsx)(n.p,{children:"Using Docker can require some more advanced system knowledge - beginners might want to stick to one of the other installation options."}),(0,i.jsx)(n.p,{children:"This guide refers specifically to Docker / Synology. Details may differ with other systems, such as cri and podman."})]}),"\n",(0,i.jsxs)(n.admonition,{type:"warning",children:[(0,i.jsx)(n.p,{children:"Some devices and communication options won't work without specialized docker configuration options, which may not be covered in this guide."}),(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"It's a good idea to test your configuration and setup in a non-docker environment first, to rule out any issues not related to containerisation."})})})]}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:"At the moment, only the following CPU architectures are supported:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"AMD64"}),"\n",(0,i.jsx)(n.li,{children:"ARMv6"}),"\n",(0,i.jsx)(n.li,{children:"aarch64"}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"It's best to start with a known-working evcc setup using one of the other installation methods:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"linux",children:"Debian, Ubuntu, Raspberry Pi"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"macos",children:"macOS"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"manual",children:"Manual Installation (including Windows)"})}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"Where possible, we recommend carrying out this initial setup on the same system that you plan to run containerised evcc on."})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If necessary, copy your resulting ",(0,i.jsx)(n.code,{children:"evcc.yaml"})," to the system that you intend to run Containerised evcc on."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Create a directory to store evcc's SQLite database (e.g ",(0,i.jsx)(n.code,{children:"~/.evcc"}),")."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsxs)(n.p,{children:["The Container can either be created manually via the command line, or using a ",(0,i.jsx)(n.code,{children:"docker-compose"})," file."]}),"\n",(0,i.jsx)(n.h3,{id:"command-line",children:"Command Line"}),"\n",(0,i.jsx)(n.p,{children:"Start the container using one of the following commands:"}),"\n",(0,i.jsxs)(o.Z,{groupId:"docker",children:[(0,i.jsx)(r.Z,{value:"default",label:"Standard",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"docker run \\\n-d \\\n--name evcc \\\n-v $(pwd)/evcc.yaml:/etc/evcc.yaml \\\n-v $(pwd)/.evcc:/root/.evcc \\\n-p 7070:7070 \\\n-p 8887:8887 \\\n-p 7090:7090/udp \\\n-p 9522:9522/udp \\\nevcc/evcc:latest\n"})})}),(0,i.jsxs)(r.Z,{value:"sma",label:"SMA devices and EEBus",children:[(0,i.jsx)(n.p,{children:"evcc requires a static Machine ID when using SMA Sunny Home Manager. If this applies to you, append the following to your command:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"--network host\n-v /etc/machine-id:/etc/machine-id \\\n"})}),(0,i.jsxs)(n.p,{children:["Alternatively, you can define a Machine ID under the ",(0,i.jsx)(n.code,{children:"plant"})," key in your ",(0,i.jsx)(n.code,{children:"evcc.yaml"}),"."]})]})]}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:"The following image tags are used:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"evcc/evcc:latest"})," for the current stable release. (recommended)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"evcc/evcc:nightly"})," for the latest, potentially unstable build."]}),"\n"]})]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Depending on your installation, you may need to prepend ",(0,i.jsx)(n.code,{children:"docker"})," commands with ",(0,i.jsx)(n.code,{children:"sudo"}),"."]})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"-d"})," flag will automatically destroy the evcc container once it has stopped. You'll then need to relaunch it again with the same command."]})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Never"})," mount the host's ",(0,i.jsx)(n.code,{children:"/etc"})," directory as a volume to the container, only specific configuration files!"]})}),"\n",(0,i.jsxs)(n.h3,{id:"with-docker-compose",children:["With ",(0,i.jsx)(n.a,{href:"https://docs.docker.com/compose",children:"docker-compose"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://docs.docker.com/compose",children:"docker-compose"})," has some useful advantages over using the command line, especially if you want to combine other applications (such as tr\xe6fik) with evcc."]}),"\n",(0,i.jsxs)(n.p,{children:["Simply copy the following configuration into a ",(0,i.jsx)(n.code,{children:"docker-compose.yaml"})," in your working directory:"]}),"\n",(0,i.jsxs)(o.Z,{groupId:"docker",children:[(0,i.jsxs)(r.Z,{value:"default",label:"Standard",default:!0,children:[(0,i.jsx)(n.p,{children:'version: "3"\nservices:\nevcc:\ncommand:'}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["evcc\ncontainer_name: evcc\nimage: evcc/evcc",":latest","\nports:"]}),"\n",(0,i.jsx)(n.li,{children:"7070:7070/tcp"}),"\n",(0,i.jsx)(n.li,{children:"8887:8887/tcp"}),"\n",(0,i.jsx)(n.li,{children:"7090:7090/udp"}),"\n",(0,i.jsx)(n.li,{children:"9522:9522/udp\nvolumes:"}),"\n",(0,i.jsx)(n.li,{children:"/etc/evcc.yaml:/etc/evcc.yaml"}),"\n",(0,i.jsx)(n.li,{children:"/home/[user]/.evcc:/root/.evcc\nrestart: unless-stopped"}),"\n"]})]}),(0,i.jsxs)(r.Z,{value:"sma",label:"SMA Ger\xe4te und EEBus",children:[(0,i.jsx)(n.p,{children:"network_mode: host\nvolumes:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"/etc/machine-id:/etc/machine-id"}),"\n",(0,i.jsx)(n.li,{children:"/var/lib/dbus/machine-id:/var/lib/dbus/machine-id"}),"\n"]})]})]}),"\n",(0,i.jsx)(n.p,{children:"Now start the container:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"docker-compose up -d\n"})}),"\n",(0,i.jsx)(n.p,{children:"This will remain in the background until you stop it."}),"\n",(0,i.jsx)(n.h2,{id:"useful-commands",children:"Useful Commands"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Show all containers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"docker ps -a\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Get the logs from the evcc container:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"docker logs evcc\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Validate the meter configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"docker exec evcc evcc -l debug meter\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Validate the charger configuraiton:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"docker exec evcc evcc -l debug charger\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Validate the vehicle configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"docker exec evcc evcc -l debug vehicle\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You should be able to find the evcc interface at ",(0,i.jsx)(n.code,{children:"http://127.0.0.1:7070"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Replace ",(0,i.jsx)(n.code,{children:"127.0.0.1"})," with the IP address or hostname of the system you're running evcc on, if appropriate."]})}),"\n",(0,i.jsx)(n.h2,{id:"upgrades",children:"Upgrades"}),"\n",(0,i.jsx)(n.p,{children:"To update to the latest version of evcc, follow this guide:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Open a Terminal"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Get the latest release of evcc (changing the tag if appropriate):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"docker pull evcc/evcc:latest\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Stop and remove the evcc container:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"docker stop evcc\ndocker rm evcc\n# or\ndocker-compose down\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Restart the container using the appropriate incantation above."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"nas-systems",children:"NAS systems"}),"\n",(0,i.jsx)(n.h3,{id:"synology-nas",children:"Synology NAS"}),"\n",(0,i.jsxs)(n.p,{children:["You can install evcc via Docker on Synology NAS systems using its graphical interface, without using the command line.\nYou'll be given the choice of two network modes: bridge, or host. Whether the Bridge mode can be used depends on what components you're using, and how they communicate with your equipment.\nIn case of doubt, use host mode. Further information can be found in this useful PDF:\n(DE) ",(0,i.jsx)(n.a,{href:"https://github.com/evcc-io/docs/files/10365841/Anleitung.EVCC.Synology.Docker.Elli.Charger.Connect-Pro.pdf",children:"Anleitung.EVCC.Synology.Docker.Elli.Charger.Connect-Pro.pdf"})]}),"\n",(0,i.jsxs)(n.p,{children:["More information on Bridge Mode can be found here:\n(DE)",(0,i.jsx)(n.a,{href:"https://github.com/evcc-io/docs/files/10365845/EVCC_Synology_Docker-2.pdf",children:"EVCC_Synology_Docker-2.pdf"})," (erstellt von at4hawo1)"]}),"\n",(0,i.jsx)(n.h4,{id:"qnap-nas",children:"QNAP NAS"}),"\n",(0,i.jsxs)(n.p,{children:["Installing evcc on QNAP systems via Docker is very similar to the above Synology instructions.\nFurther QNAP specific instructions can be found here:\n(DE) ",(0,i.jsx)(n.a,{href:"https://github.com/evcc-io/docs/files/11241693/EVCC_auf_QNAP_Container_Station.pdf",children:"EVCC_auf_QNAP_Container_Station.pdf"})]})]})}function p(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},5162:(e,n,t)=>{t.d(n,{Z:()=>r});t(7294);var i=t(512);const s={tabItem:"tabItem_Ymn6"};var o=t(5893);function r(e){let{children:n,hidden:t,className:r}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,i.Z)(s.tabItem,r),hidden:t,children:n})}},4866:(e,n,t)=>{t.d(n,{Z:()=>k});var i=t(7294),s=t(512),o=t(2466),r=t(6550),c=t(469),a=t(1980),l=t(7392),d=t(12);function u(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,i.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:i,default:s}}=e;return{value:n,label:t,attributes:i,default:s}}))}(t);return function(e){const n=(0,l.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const s=(0,r.k6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,a._X)(o),(0,i.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(s.location.search);n.set(o,e),s.replace({...s.location,search:n.toString()})}),[o,s])]}function x(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,o=h(e),[r,a]=(0,i.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const i=t.find((e=>e.default))??t[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:o}))),[l,u]=m({queryString:t,groupId:s}),[x,j]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,o]=(0,d.Nk)(t);return[s,(0,i.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:s}),v=(()=>{const e=l??x;return p({value:e,tabValues:o})?e:null})();(0,c.Z)((()=>{v&&a(v)}),[v]);return{selectedValue:r,selectValue:(0,i.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);a(e),u(e),j(e)}),[u,j,o]),tabValues:o}}var j=t(2389);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=t(5893);function g(e){let{className:n,block:t,selectedValue:i,selectValue:r,tabValues:c}=e;const a=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.o5)(),d=e=>{const n=e.currentTarget,t=a.indexOf(n),s=c[t].value;s!==i&&(l(n),r(s))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=a.indexOf(e.currentTarget)+1;n=a[t]??a[0];break}case"ArrowLeft":{const t=a.indexOf(e.currentTarget)-1;n=a[t]??a[a.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":t},n),children:c.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,ref:e=>a.push(e),onKeyDown:u,onClick:d,...o,className:(0,s.Z)("tabs__item",v.tabItem,o?.className,{"tabs__item--active":i===n}),children:t??n},n)}))})}function y(e){let{lazy:n,children:t,selectedValue:s}=e;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===s));return e?(0,i.cloneElement)(e,{className:"margin-top--md"}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function b(e){const n=x(e);return(0,f.jsxs)("div",{className:(0,s.Z)("tabs-container",v.tabList),children:[(0,f.jsx)(g,{...e,...n}),(0,f.jsx)(y,{...e,...n})]})}function k(e){const n=(0,j.Z)();return(0,f.jsx)(b,{...e,children:u(e.children)},String(n))}},1151:(e,n,t)=>{t.d(n,{Z:()=>c,a:()=>r});var i=t(7294);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);